"""
Localization system for UI Easy application
"""

import json
import os
from typing import Dict, Any

class Localization:
    """Manages localization for the application"""
    
    def __init__(self, language: str = "zh_CN"):
        self.language = language
        self.translations: Dict[str, Dict[str, str]] = {}
        self.current_translations: Dict[str, str] = {}
        self.load_translations()
    
    def load_translations(self):
        """Load translation dictionaries"""
        # Define translations inline for now
        self.translations = {
            "zh_CN": {
                # Window title
                "window_title": "UI Easy - AIé©±åŠ¨çš„è®¾è®¡å·¥å…·",
                "main_title": "UI Easy - ä¸“ä¸šè®¾è®¡åˆ†æžå·¥å…·",
                
                # Tabs
                "tab_image_analyzer": "å›¾åƒåˆ†æžå™¨",
                "tab_requirement_analyzer": "éœ€æ±‚åˆ†æžå™¨", 
                "tab_prototype_generator": "åŽŸåž‹ç”Ÿæˆå™¨",
                "tab_settings": "è®¾ç½®",
                
                # Image Analyzer
                "image_selection": "å›¾åƒé€‰æ‹©",
                "select_image": "é€‰æ‹©è®¾è®¡å›¾åƒ",
                "no_image_selected": "æœªé€‰æ‹©å›¾åƒ",
                "analysis_options": "åˆ†æžé€‰é¡¹",
                "analysis_type": "åˆ†æžç±»åž‹:",
                "full_analysis": "å®Œæ•´åˆ†æž",
                "layout_only": "ä»…å¸ƒå±€",
                "colors_only": "ä»…é¢œè‰²",
                "components_only": "ä»…ç»„ä»¶",
                "analyze_design": "åˆ†æžè®¾è®¡",
                "progress": "è¿›åº¦",
                "ready": "å°±ç»ª",
                "analysis_results": "åˆ†æžç»“æžœ",
                "analysis_placeholder": "åˆ†æžç»“æžœå°†åœ¨æ­¤å¤„æ˜¾ç¤º...",
                "export_json": "å¯¼å‡º JSON",
                "export_txt": "å¯¼å‡ºæ–‡æœ¬",
                
                # Requirement Analyzer
                "requirements_input": "éœ€æ±‚è¾“å…¥",
                "requirements_text": "éœ€æ±‚æ–‡æœ¬:",
                "requirements_placeholder": "åœ¨æ­¤è¾“å…¥æ‚¨çš„éœ€æ±‚...\n\nç¤ºä¾‹:\næˆ‘éœ€è¦ä¸€ä¸ªä»»åŠ¡ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å«ï¼š\n1. ç”¨æˆ·ç™»å½•åŠŸèƒ½\n2. åˆ›å»ºå’Œç¼–è¾‘ä»»åŠ¡\n3. ä»»åŠ¡åˆ—è¡¨æ˜¾ç¤º\n4. ä»»åŠ¡çŠ¶æ€ç®¡ç†",
                "additional_context": "é™„åŠ ä¸Šä¸‹æ–‡ (å¯é€‰):",
                "context_placeholder": "æä¾›å…³äºŽæ‚¨é¡¹ç›®çš„é™„åŠ ä¸Šä¸‹æ–‡...",
                "target_platform": "ç›®æ ‡å¹³å°:",
                "analyze_requirements": "åˆ†æžéœ€æ±‚",
                "analysis_progress": "åˆ†æžè¿›åº¦",
                "overview": "æ¦‚è§ˆ",
                "requirements": "éœ€æ±‚",
                "components": "ç»„ä»¶",
                "quality_recommendations": "è´¨é‡ä¸Žå»ºè®®",
                "filter_by_type": "æŒ‰ç±»åž‹è¿‡æ»¤:",
                "priority": "ä¼˜å…ˆçº§:",
                "export_report": "å¯¼å‡ºæŠ¥å‘Š",
                
                # Settings
                "app_settings": "åº”ç”¨è®¾ç½®",
                "model_config": "æ¨¡åž‹é…ç½® (Model Configuration)",
                "model_config_desc": "é…ç½®ä¸åŒçš„ AI æ¨¡åž‹ä»¥ç”¨äºŽå›¾åƒåˆ†æžå’Œéœ€æ±‚åˆ†æžã€‚è‡³å°‘éœ€è¦é…ç½®ä¸€ä¸ªæ¨¡åž‹ã€‚",
                "select_model": "é€‰æ‹©æ¨¡åž‹:",
                "add_model": "æ·»åŠ æ¨¡åž‹",
                "delete_model": "åˆ é™¤æ¨¡åž‹",
                "model_details": "æ¨¡åž‹è¯¦ç»†é…ç½®",
                "model_name": "æ¨¡åž‹åç§°:",
                "provider": "æä¾›å•†:",
                "api_key": "API å¯†é’¥:",
                "base_url": "åŸºç¡€ URL:",
                "model_id": "æ¨¡åž‹ ID:",
                "max_tokens": "æœ€å¤§ä»¤ç‰Œæ•°:",
                "temperature": "æ¸©åº¦:",
                "timeout": "è¶…æ—¶ (ç§’):",
                "update_model": "æ›´æ–°æ¨¡åž‹é…ç½®",
                "module_config": "æ¨¡å—é…ç½® (Module Configuration)",
                "module_config_desc": "ä¸ºæ¯ä¸ªåˆ†æžæ¨¡å—é…ç½®ç›¸å…³è®¾ç½®ï¼Œé€‰æ‹©ä½¿ç”¨çš„æ¨¡åž‹å’Œè‡ªå®šä¹‰æç¤ºã€‚",
                "select_module": "é€‰æ‹©æ¨¡å—:",
                "enable_module": "å¯ç”¨æ¨¡å—:",
                "use_model": "ä½¿ç”¨æ¨¡åž‹:",
                "custom_prompts": "è‡ªå®šä¹‰æç¤º (å¯é€‰):",
                "prompt_placeholder": "è¾“å…¥è‡ªå®šä¹‰æç¤ºè¯...",
                "update_module": "æ›´æ–°æ¨¡å—é…ç½®",
                "app_settings_title": "åº”ç”¨è®¾ç½® (Application Settings)",
                "ui_language": "ç•Œé¢è¯­è¨€:",
                "default_analysis_type": "é»˜è®¤åˆ†æžç±»åž‹:",
                "auto_save_results": "è‡ªåŠ¨ä¿å­˜ç»“æžœ:",
                "default_export_format": "é»˜è®¤å¯¼å‡ºæ ¼å¼:",
                "test_config": "æµ‹è¯•é…ç½®",
                "save_settings": "ä¿å­˜è®¾ç½®",
                "reload_settings": "é‡æ–°åŠ è½½è®¾ç½®",
                
                # Messages
                "success": "æˆåŠŸ",
                "error": "é”™è¯¯",
                "warning": "è­¦å‘Š",
                "settings_saved": "è®¾ç½®å·²ä¿å­˜ï¼",
                "settings_loaded": "è®¾ç½®å·²é‡æ–°åŠ è½½ï¼",
                "model_updated": "æ¨¡åž‹é…ç½®å·²æ›´æ–°ï¼",
                "module_updated": "æ¨¡å—é…ç½®å·²æ›´æ–°ï¼",
                "config_error": "é…ç½®é”™è¯¯",
                "api_key_required": "è¯·åœ¨è®¾ç½®ä¸­é…ç½® API å¯†é’¥åŽå†åˆ†æž",
                "select_image_first": "è¯·å…ˆé€‰æ‹©å›¾åƒ",
                "enter_requirements": "è¯·å…ˆè¾“å…¥éœ€æ±‚æ–‡æœ¬",
                "model_name_required": "æ¨¡åž‹åç§°ä¸èƒ½ä¸ºç©ºï¼",
                "api_key_empty": "API å¯†é’¥ä¸èƒ½ä¸ºç©ºï¼",
                "model_exists": "æ¨¡åž‹åç§°å·²å­˜åœ¨ï¼",
                "confirm_delete": "ç¡®è®¤åˆ é™¤",
                "confirm_delete_model": "ç¡®å®šè¦åˆ é™¤æ¨¡åž‹é…ç½®å—ï¼Ÿ",
                "enter_model_name": "è¾“å…¥æ¨¡åž‹åç§°:",
                "add_model_title": "æ·»åŠ æ¨¡åž‹",
                "analysis_failed": "åˆ†æžå¤±è´¥",
                "analysis_completed": "åˆ†æžå®Œæˆ",
                "export_success": "å¯¼å‡ºæˆåŠŸ",
                "export_failed": "å¯¼å‡ºå¤±è´¥",
                
                # Status messages
                "analyzing_image": "æ­£åœ¨åˆ†æžå›¾åƒï¼Œè¯·ç¨å€™...",
                "analyzing_requirements": "æ­£åœ¨åˆ†æžéœ€æ±‚ï¼Œè¯·ç¨å€™...",
                "analysis_complete": "åˆ†æžå®Œæˆ",
                "analysis_type_label": "åˆ†æžç±»åž‹",
                "timestamp": "æ—¶é—´æˆ³",
                "model_used": "ä½¿ç”¨æ¨¡åž‹",
                "confidence": "ç½®ä¿¡åº¦",
                
                # Filters
                "all": "å…¨éƒ¨",
                "functional": "åŠŸèƒ½æ€§",
                "ui_component": "UI ç»„ä»¶",
                "layout": "å¸ƒå±€",
                "styling": "æ ·å¼",
                "interaction": "äº¤äº’",
                "data": "æ•°æ®",
                "performance": "æ€§èƒ½",
                "accessibility": "å¯è®¿é—®æ€§",
                "business": "ä¸šåŠ¡",
                "critical": "å…³é”®",
                "high": "é«˜",
                "medium": "ä¸­",
                "low": "ä½Ž",
                
                # Platforms
                "web": "ç½‘é¡µ",
                "mobile": "ç§»åŠ¨ç«¯",
                "desktop": "æ¡Œé¢ç«¯",
                
                # Export formats
                "json": "JSON",
                "txt": "æ–‡æœ¬",
                "both": "ä¸¤è€…",
                
                # Prototype generator
                "prototype_coming_soon": "åŽŸåž‹ç”Ÿæˆå™¨ - å³å°†æŽ¨å‡º",
                "prototype_inputs": "è¾“å…¥æº",
                "input_management": "è¾“å…¥ç®¡ç†",
                "add_text_input": "æ·»åŠ æ–‡æœ¬è¾“å…¥",
                "add_image_analysis": "æ·»åŠ å›¾åƒåˆ†æžç»“æžœ", 
                "add_requirement_analysis": "æ·»åŠ éœ€æ±‚åˆ†æžç»“æžœ",
                "input_name": "è¾“å…¥åç§°:",
                "input_content": "è¾“å…¥å†…å®¹:",
                "prototype_settings": "åŽŸåž‹è®¾ç½®",
                "prototype_type": "åŽŸåž‹ç±»åž‹:",
                "framework": "æ¡†æž¶:",
                "style_framework": "æ ·å¼æ¡†æž¶:",
                "responsive_design": "å“åº”å¼è®¾è®¡:",
                "accessibility_support": "æ— éšœç¢æ”¯æŒ:",
                "generate_prototype": "ç”ŸæˆåŽŸåž‹",
                "prototype_results": "åŽŸåž‹ç»“æžœ",
                "code_preview": "ä»£ç é¢„è§ˆ",
                "html_code": "HTML ä»£ç ",
                "css_code": "CSS ä»£ç ", 
                "js_code": "JavaScript ä»£ç ",
                "component_structure": "ç»„ä»¶ç»“æž„",
                "design_rationale": "è®¾è®¡ç†å¿µ",
                "implementation_notes": "å®žçŽ°è¦ç‚¹",
                "preview": "é¢„è§ˆ",
                "export_prototype": "å¯¼å‡ºåŽŸåž‹",
                "export_html": "å¯¼å‡º HTML",
                "export_separate": "åˆ†åˆ«å¯¼å‡º",
                "text_input": "æ–‡æœ¬è¾“å…¥",
                "image_analysis_result": "å›¾åƒåˆ†æžç»“æžœ",
                "requirement_analysis_result": "éœ€æ±‚åˆ†æžç»“æžœ",
                "no_inputs": "æš‚æ— è¾“å…¥æº",
                "input_preview": "è¾“å…¥é¢„è§ˆ",
                "remove_input": "ç§»é™¤è¾“å…¥",
                "clear_all_inputs": "æ¸…é™¤æ‰€æœ‰è¾“å…¥",
                "prototype_generation": "åŽŸåž‹ç”Ÿæˆ",
                "generating_prototype": "æ­£åœ¨ç”ŸæˆåŽŸåž‹...",
                "prototype_generated": "åŽŸåž‹ç”Ÿæˆå®Œæˆ",
                "prototype_generation_failed": "åŽŸåž‹ç”Ÿæˆå¤±è´¥",
                "no_prototype_result": "æš‚æ— åŽŸåž‹ç»“æžœ",
                "html_css_js": "HTML/CSS/JS",
                "react": "React",
                "vue": "Vue",
                "angular": "Angular",
                "bootstrap": "Bootstrap",
                "tailwind": "Tailwind CSS",
                "custom": "è‡ªå®šä¹‰",
                "enable": "å¯ç”¨",
                "disable": "ç¦ç”¨",
                "items": "é¡¹",
                "prototype_export_success": "åŽŸåž‹å¯¼å‡ºæˆåŠŸ",
                "prototype_export_failed": "åŽŸåž‹å¯¼å‡ºå¤±è´¥",
                "select_export_location": "é€‰æ‹©å¯¼å‡ºä½ç½®",
                "html_files": "HTML æ–‡ä»¶ (*.html)",
                "json_files": "JSON æ–‡ä»¶ (*.json)",
                
                # Additional UI elements that need localization
                "image_files": "å›¾åƒæ–‡ä»¶ (*.png *.jpg *.jpeg *.gif *.bmp)",
                "select_design_image": "é€‰æ‹©è®¾è®¡å›¾åƒ",
                "configuration_test_results": "é…ç½®æµ‹è¯•ç»“æžœ",
                "test_results": "æµ‹è¯•ç»“æžœ",
                "successful_models": "æˆåŠŸé…ç½®çš„æ¨¡åž‹",
                "configuration_issues": "é…ç½®é—®é¢˜",
                "module_status": "æ¨¡å—çŠ¶æ€",
                "enabled_using_model": "å·²å¯ç”¨ï¼Œä½¿ç”¨æ¨¡åž‹",
                "enabled_invalid_model": "å·²å¯ç”¨ä½†æ¨¡åž‹é…ç½®æ— æ•ˆ",
                "disabled": "å·²ç¦ç”¨",
                "missing_api_key": "ç¼ºå°‘ API å¯†é’¥",
                "openai_needs_model_id": "OpenAI æ¨¡åž‹éœ€è¦æŒ‡å®š model_id",
                "deepseek_needs_base_url": "DeepSeek æ¨¡åž‹éœ€è¦æŒ‡å®š base_url",
                "config_test_error": "æµ‹è¯•é…ç½®æ—¶å‡ºé”™",
                "failed_load_initial_settings": "åŠ è½½åˆå§‹è®¾ç½®å¤±è´¥",
                "failed_save_settings": "ä¿å­˜è®¾ç½®å¤±è´¥",
                "failed_update_ui_language": "æ›´æ–°UIè¯­è¨€å¤±è´¥",
                "auto_save_failed": "è‡ªåŠ¨ä¿å­˜å¤±è´¥",
                "display_error": "æ˜¾ç¤ºé”™è¯¯",
                "failed_display_results": "æ˜¾ç¤ºç»“æžœå¤±è´¥",
                "export_requirements_as_json": "å¯¼å‡ºéœ€æ±‚åˆ†æžä¸º JSON",
                "export_requirements_report": "å¯¼å‡ºéœ€æ±‚æŠ¥å‘Š",
                "requirements_analysis": "éœ€æ±‚åˆ†æž",
                "requirements_report": "éœ€æ±‚æŠ¥å‘Š",
                "export_analysis_as_json": "å¯¼å‡ºåˆ†æžä¸º JSON",
                "export_analysis_as_text": "å¯¼å‡ºåˆ†æžä¸ºæ–‡æœ¬",
                "analysis_result": "åˆ†æžç»“æžœ",
                "warning": "è­¦å‘Š",
                "confirm": "ç¡®è®¤",
                "cancel": "å–æ¶ˆ",
                "yes": "æ˜¯",
                "no": "å¦",
                "ok": "ç¡®å®š",
                "failed_to_load_image": "åŠ è½½å›¾åƒå¤±è´¥",
                "failed_to_export": "å¯¼å‡ºå¤±è´¥",
                "export_error": "å¯¼å‡ºé”™è¯¯",
                "analysis_error": "åˆ†æžé”™è¯¯",
                "failed_load_settings": "åŠ è½½è®¾ç½®å¤±è´¥",
                "analysis_overview": "åˆ†æžæ¦‚è¿°",
                "requirements_list": "éœ€æ±‚åˆ—è¡¨",
                "items": "é¡¹",
                "component_specifications": "ç»„ä»¶è§„æ ¼",
                "no_ui_components": "éœ€æ±‚ä¸­æœªè¯†åˆ«åˆ°UIç»„ä»¶",
                "component": "ç»„ä»¶",
                "description": "æè¿°",
                "type": "ç±»åž‹",
                "name": "åç§°",
                "properties": "å±žæ€§",
                "events": "äº‹ä»¶",
                "validation": "éªŒè¯",
                "accessibility": "å¯è®¿é—®æ€§",
                "quality_analysis": "è´¨é‡åˆ†æž",
                "analysis_scores": "åˆ†æžå¾—åˆ†",
                "completeness_score": "å®Œæ•´æ€§å¾—åˆ†",
                "clarity_score": "æ¸…æ™°åº¦å¾—åˆ†",
                "feasibility_score": "å¯è¡Œæ€§å¾—åˆ†",
                "identified_gaps": "è¯†åˆ«çš„å·®è·",
                "ambiguities_clarify": "éœ€è¦æ¾„æ¸…çš„æ¨¡ç³Šç‚¹",
                "recommendations": "å»ºè®®",
                "development_phases": "å¼€å‘é˜¶æ®µ",
                "duration": "æŒç»­æ—¶é—´",
                "title": "æ ‡é¢˜",
                "status": "çŠ¶æ€",
                "acceptance_criteria": "éªŒæ”¶æ ‡å‡†",
                "estimated_effort": "é¢„ä¼°å·¥ä½œé‡",
                "rationale": "åŸºç¡€åŽŸç†",
                "project_overview": "é¡¹ç›®æ¦‚è¿°",
                "target_audience": "ç›®æ ‡ç”¨æˆ·",
                "quality_scores": "è´¨é‡è¯„åˆ†",
                "completeness": "å®Œæ•´æ€§",
                "clarity": "æ¸…æ™°åº¦",
                "feasibility": "å¯è¡Œæ€§",
                "development_estimation": "å¼€å‘é¢„ä¼°",
                "recommended_frameworks": "æŽ¨èæ¡†æž¶",
                "analysis_summary": "åˆ†æžç»“æžœæ‘˜è¦",
                "analyzing_image_please_wait": "æ­£åœ¨åˆ†æžå›¾åƒï¼Œè¯·ç¨å€™...",
                "analyzing_requirements_please_wait": "æ­£åœ¨åˆ†æžéœ€æ±‚ï¼Œè¯·ç¨å€™...",
                "analysis_completed_meta": "åˆ†æžå®Œæˆ",
                "analysis_type_meta": "åˆ†æžç±»åž‹",
                "timestamp_meta": "æ—¶é—´æˆ³",
                "model_used_meta": "ä½¿ç”¨æ¨¡åž‹",
                "confidence_meta": "ç½®ä¿¡åº¦",
                "unknown": "æœªçŸ¥",
                "na": "ä¸é€‚ç”¨",
                
                # Requirements analysis progress messages
                "analyzing_project_overview": "ðŸ” æ­£åœ¨åˆ†æžé¡¹ç›®æ¦‚è¿°...",
                "extracting_requirements": "ðŸ“‹ æ­£åœ¨æå–å’Œåˆ†ç±»éœ€æ±‚...",
                "analyzing_ui_components": "ðŸŽ¨ æ­£åœ¨åˆ†æž {count} ä¸ªUIç»„ä»¶...",
                "no_ui_components_found": "âš ï¸ æœªæ‰¾åˆ°UIç»„ä»¶éœ€æ±‚ï¼Œè·³è¿‡ç»„ä»¶åˆ†æžã€‚",
                "analyzing_component": "åˆ†æžç»„ä»¶ {current}/{total}: {title}",
                "component_analysis_complete": "âœ… ç»„ä»¶ {title} åˆ†æžå®Œæˆ",
                "component_analysis_failed": "âš ï¸ ç»„ä»¶ {title} åˆ†æžå¤±è´¥",
                "starting_requirements_analysis": "å¼€å§‹éœ€æ±‚åˆ†æž...",
                "analyzing_requirements_overview": "æ­£åœ¨åˆ†æžéœ€æ±‚æ¦‚è¿°...",
                "extracting_categorizing_requirements": "æ­£åœ¨æå–å’Œåˆ†ç±»éœ€æ±‚...",
                "analyzing_ui_components_phase": "æ­£åœ¨åˆ†æžUIç»„ä»¶...",
                "analyzing_layout_interactions": "æ­£åœ¨åˆ†æžå¸ƒå±€å’Œäº¤äº’...",
                "validating_requirements": "æ­£åœ¨éªŒè¯éœ€æ±‚...",
                "requirements_analysis_completed": "éœ€æ±‚åˆ†æžå®Œæˆ",
                
                # Gap analysis messages
                "gap_no_ui_components": "æœªè¯†åˆ«å‡ºå…·ä½“çš„UIç»„ä»¶",
                "gap_no_layout": "æœªå®šä¹‰å¸ƒå±€ç»“æž„",
                "gap_no_styling": "ç¼ºå°‘è§†è§‰æ ·å¼è¦æ±‚",
                "gap_no_interactions": "æœªæŒ‡å®šç”¨æˆ·äº¤äº’æ¨¡å¼",
                "gap_missing_description": "éœ€æ±‚ '{title}' ç¼ºå°‘æè¿°",
                "gap_missing_acceptance_criteria": "éœ€æ±‚ '{title}' ç¼ºå°‘éªŒæ”¶æ ‡å‡†",
                
                # Recommendation messages
                "recommendation_address_gaps": "è§£å†³ç¼ºå¤±çš„éœ€æ±‚ä»¥ç¡®ä¿å®Œæ•´çš„è§„æ ¼è¯´æ˜Ž",
                "recommendation_clarify_ambiguities": "æ¾„æ¸…æ¨¡ç³Šçš„éœ€æ±‚ä»¥é¿å…å®žçŽ°æ··ä¹±",
                "recommendation_reduce_critical": "è€ƒè™‘å‡å°‘å…³é”®éœ€æ±‚ - å¤ªå¤šå…³é”®é¡¹ç›®å¯èƒ½å½±å“äº¤ä»˜",
                "recommendation_identify_critical": "è¯†åˆ«å…³é”®éœ€æ±‚ä»¥ä¼˜å…ˆå¼€å‘å·¥ä½œ",
                
                # Ambiguity messages
                "ambiguity_vague_language": "éœ€æ±‚ '{title}' ä¸­å«æœ‰æ¨¡ç³Šè¯­è¨€: åŒ…å« '{word}'",
                "ambiguity_contradictory": "éœ€æ±‚ '{title}' ä¸­å­˜åœ¨çŸ›ç›¾çš„å¤æ‚æ€§è¦æ±‚",
                
                # Two-phase analysis messages
                "starting_requirements_list_extraction": "å¼€å§‹æå–éœ€æ±‚åˆ—è¡¨...",
                "extracting_requirements_list": "ðŸ“‹ æ­£åœ¨æå–éœ€æ±‚åˆ—è¡¨...",
                "requirements_list_extraction_completed": "éœ€æ±‚åˆ—è¡¨æå–å®Œæˆ",
                "starting_detailed_analysis": "å¼€å§‹è¯¦ç»†åˆ†æž...",
                "analyzing_requirement_detail": "æ­£åœ¨åˆ†æžéœ€æ±‚ {current}/{total}: {title}",
                "detailed_analysis_completed": "è¯¦ç»†åˆ†æžå®Œæˆ",
                "recommendation_proceed_detailed_analysis": "å»ºè®®ç»§ç»­è¿›è¡Œè¯¦ç»†åˆ†æžä»¥èŽ·å–å®Œæ•´çš„éœ€æ±‚è§„æ ¼",
                "analyzing_component_detail": "æ­£åœ¨è¯¦ç»†åˆ†æžç»„ä»¶: {title}",
                "analyzing_layout_detail": "æ­£åœ¨è¯¦ç»†åˆ†æžå¸ƒå±€: {title}",
                "analyzing_interaction_detail": "æ­£åœ¨è¯¦ç»†åˆ†æžäº¤äº’: {title}",
                "layout_analysis_complete": "âœ… å¸ƒå±€ {title} åˆ†æžå®Œæˆ",
                "layout_analysis_failed": "âš ï¸ å¸ƒå±€ {title} åˆ†æžå¤±è´¥",
                "interaction_analysis_complete": "âœ… äº¤äº’ {title} åˆ†æžå®Œæˆ",
                "interaction_analysis_failed": "âš ï¸ äº¤äº’ {title} åˆ†æžå¤±è´¥",
                "extract_requirement_list": "æå–éœ€æ±‚åˆ—è¡¨",
                "detailed_analysis": "è¯¦ç»†åˆ†æž",
                "extract_requirement_list_first": "è¯·å…ˆæå–éœ€æ±‚åˆ—è¡¨",
            },
            "en_US": {
                # Window title
                "window_title": "UI Easy - AI-Powered Design Tool",
                "main_title": "UI Easy - Professional Design Analysis Tool",
                
                # Tabs
                "tab_image_analyzer": "Image Analyzer",
                "tab_requirement_analyzer": "Requirement Analyzer",
                "tab_prototype_generator": "Prototype Generator",
                "tab_settings": "Settings",
                
                # Image Analyzer
                "image_selection": "Image Selection",
                "select_image": "Select Design Image",
                "no_image_selected": "No image selected",
                "analysis_options": "Analysis Options",
                "analysis_type": "Analysis Type:",
                "full_analysis": "Full Analysis",
                "layout_only": "Layout Only",
                "colors_only": "Colors Only",
                "components_only": "Components Only",
                "analyze_design": "Analyze Design",
                "progress": "Progress",
                "ready": "Ready",
                "analysis_results": "Analysis Results",
                "analysis_placeholder": "Analysis results will appear here...",
                "export_json": "Export JSON",
                "export_txt": "Export Text",
                
                # Requirement Analyzer
                "requirements_input": "Requirements Input",
                "requirements_text": "Requirements Text:",
                "requirements_placeholder": "Enter your requirements here...\n\nExample:\nI need a task management system with:\n1. User login functionality\n2. Create and edit tasks\n3. Task list display\n4. Task status management",
                "additional_context": "Additional Context (Optional):",
                "context_placeholder": "Provide additional context about your project...",
                "target_platform": "Target Platform:",
                "analyze_requirements": "Analyze Requirements",
                "analysis_progress": "Analysis Progress",
                "overview": "Overview",
                "requirements": "Requirements",
                "components": "Components",
                "quality_recommendations": "Quality & Recommendations",
                "filter_by_type": "Filter by Type:",
                "priority": "Priority:",
                "export_report": "Export Report",
                
                # Settings
                "app_settings": "Application Settings",
                "model_config": "Model Configuration",
                "model_config_desc": "Configure different AI models for image analysis and requirement analysis. At least one model must be configured.",
                "select_model": "Select Model:",
                "add_model": "Add Model",
                "delete_model": "Delete Model",
                "model_details": "Model Detail Configuration",
                "model_name": "Model Name:",
                "provider": "Provider:",
                "api_key": "API Key:",
                "base_url": "Base URL:",
                "model_id": "Model ID:",
                "max_tokens": "Max Tokens:",
                "temperature": "Temperature:",
                "timeout": "Timeout (seconds):",
                "update_model": "Update Model Configuration",
                "module_config": "Module Configuration",
                "module_config_desc": "Configure settings for each analysis module, select models to use and custom prompts.",
                "select_module": "Select Module:",
                "enable_module": "Enable Module:",
                "use_model": "Use Model:",
                "custom_prompts": "Custom Prompts (Optional):",
                "prompt_placeholder": "Enter custom prompts...",
                "update_module": "Update Module Configuration",
                "app_settings_title": "Application Settings",
                "ui_language": "UI Language:",
                "default_analysis_type": "Default Analysis Type:",
                "auto_save_results": "Auto-save Results:",
                "default_export_format": "Default Export Format:",
                "test_config": "Test Configuration",
                "save_settings": "Save Settings",
                "reload_settings": "Reload Settings",
                
                # Messages
                "success": "Success",
                "error": "Error",
                "warning": "Warning",
                "settings_saved": "Settings saved!",
                "settings_loaded": "Settings reloaded!",
                "model_updated": "Model configuration updated!",
                "module_updated": "Module configuration updated!",
                "config_error": "Configuration Error",
                "api_key_required": "Please configure API key in settings before analyzing",
                "select_image_first": "Please select an image first",
                "enter_requirements": "Please enter requirements text first",
                "model_name_required": "Model name cannot be empty!",
                "api_key_empty": "API key cannot be empty!",
                "model_exists": "Model name already exists!",
                "confirm_delete": "Confirm Delete",
                "confirm_delete_model": "Are you sure you want to delete this model configuration?",
                "enter_model_name": "Enter model name:",
                "add_model_title": "Add Model",
                "analysis_failed": "Analysis failed",
                "analysis_completed": "Analysis completed",
                "export_success": "Export successful",
                "export_failed": "Export failed",
                
                # Status messages
                "analyzing_image": "Analyzing image, please wait...",
                "analyzing_requirements": "Analyzing requirements, please wait...",
                "analysis_complete": "Analysis complete",
                "analysis_type_label": "Analysis Type",
                "timestamp": "Timestamp",
                "model_used": "Model Used",
                "confidence": "Confidence",
                
                # Filters
                "all": "All",
                "functional": "Functional",
                "ui_component": "UI Component",
                "layout": "Layout",
                "styling": "Styling",
                "interaction": "Interaction",
                "data": "Data",
                "performance": "Performance",
                "accessibility": "Accessibility",
                "business": "Business",
                "critical": "Critical",
                "high": "High",
                "medium": "Medium",
                "low": "Low",
                
                # Platforms
                "web": "Web",
                "mobile": "Mobile",
                "desktop": "Desktop",
                
                # Export formats
                "json": "JSON",
                "txt": "Text",
                "both": "Both",
                
                # Prototype generator
                "prototype_coming_soon": "Prototype Generator - Coming Soon",
                "prototype_inputs": "Input Sources",
                "input_management": "Input Management",
                "add_text_input": "Add Text Input",
                "add_image_analysis": "Add Image Analysis Result",
                "add_requirement_analysis": "Add Requirement Analysis Result",
                "input_name": "Input Name:",
                "input_content": "Input Content:",
                "prototype_settings": "Prototype Settings",
                "prototype_type": "Prototype Type:",
                "framework": "Framework:",
                "style_framework": "Style Framework:",
                "responsive_design": "Responsive Design:",
                "accessibility_support": "Accessibility Support:",
                "generate_prototype": "Generate Prototype",
                "prototype_results": "Prototype Results",
                "code_preview": "Code Preview",
                "html_code": "HTML Code",
                "css_code": "CSS Code",
                "js_code": "JavaScript Code",
                "component_structure": "Component Structure",
                "design_rationale": "Design Rationale",
                "implementation_notes": "Implementation Notes",
                "preview": "Preview",
                "export_prototype": "Export Prototype",
                "export_html": "Export HTML",
                "export_separate": "Export Separately",
                "text_input": "Text Input",
                "image_analysis_result": "Image Analysis Result",
                "requirement_analysis_result": "Requirement Analysis Result",
                "no_inputs": "No input sources",
                "input_preview": "Input Preview",
                "remove_input": "Remove Input",
                "clear_all_inputs": "Clear All Inputs",
                "prototype_generation": "Prototype Generation",
                "generating_prototype": "Generating prototype...",
                "prototype_generated": "Prototype generated successfully",
                "prototype_generation_failed": "Prototype generation failed",
                "no_prototype_result": "No prototype result",
                "html_css_js": "HTML/CSS/JS",
                "react": "React",
                "vue": "Vue",
                "angular": "Angular",
                "bootstrap": "Bootstrap",
                "tailwind": "Tailwind CSS",
                "custom": "Custom",
                "enable": "Enable",
                "disable": "Disable",
                "items": "items",
                "prototype_export_success": "Prototype exported successfully",
                "prototype_export_failed": "Prototype export failed",
                "select_export_location": "Select Export Location",
                "html_files": "HTML Files (*.html)",
                "json_files": "JSON Files (*.json)",
                
                # Additional UI elements that need localization
                "image_files": "Image Files (*.png *.jpg *.jpeg *.gif *.bmp)",
                "select_design_image": "Select Design Image",
                "configuration_test_results": "Configuration Test Results",
                "test_results": "Test Results",
                "successful_models": "Successfully Configured Models",
                "configuration_issues": "Configuration Issues",
                "module_status": "Module Status",
                "enabled_using_model": "Enabled, using model",
                "enabled_invalid_model": "Enabled but invalid model configuration",
                "disabled": "Disabled",
                "missing_api_key": "Missing API key",
                "openai_needs_model_id": "OpenAI models require model_id",
                "deepseek_needs_base_url": "DeepSeek models require base_url",
                "config_test_error": "Error testing configuration",
                "failed_load_initial_settings": "Failed to load initial settings",
                "failed_save_settings": "Failed to save settings",
                "failed_update_ui_language": "Failed to update UI language",
                "auto_save_failed": "Auto-save failed",
                "display_error": "Display Error",
                "failed_display_results": "Failed to display results",
                "export_requirements_as_json": "Export Requirements Analysis as JSON",
                "export_requirements_report": "Export Requirements Report",
                "requirements_analysis": "Requirements Analysis",
                "requirements_report": "Requirements Report",
                "export_analysis_as_json": "Export Analysis as JSON",
                "export_analysis_as_text": "Export Analysis as Text",
                "analysis_result": "Analysis Result",
                "warning": "Warning",
                "confirm": "Confirm",
                "cancel": "Cancel",
                "yes": "Yes",
                "no": "No",
                "ok": "OK",
                "failed_to_load_image": "Failed to load image",
                "failed_to_export": "Failed to export",
                "export_error": "Export Error",
                "analysis_error": "Analysis Error",
                "failed_load_settings": "Failed to load settings",
                "analysis_overview": "Analysis Overview",
                "requirements_list": "Requirements List",
                "items": "items",
                "component_specifications": "Component Specifications",
                "no_ui_components": "No UI components identified in the requirements",
                "component": "Component",
                "description": "Description",
                "type": "Type",
                "name": "Name",
                "properties": "Properties",
                "events": "Events",
                "validation": "Validation",
                "accessibility": "Accessibility",
                "quality_analysis": "Quality Analysis",
                "analysis_scores": "Analysis Scores",
                "completeness_score": "Completeness Score",
                "clarity_score": "Clarity Score",
                "feasibility_score": "Feasibility Score",
                "identified_gaps": "Identified Gaps",
                "ambiguities_clarify": "Ambiguities to Clarify",
                "recommendations": "Recommendations",
                "development_phases": "Development Phases",
                "duration": "Duration",
                "title": "Title",
                "status": "Status",
                "acceptance_criteria": "Acceptance Criteria",
                "estimated_effort": "Estimated Effort",
                "rationale": "Rationale",
                "project_overview": "Project Overview",
                "target_audience": "Target Audience",
                "quality_scores": "Quality Scores",
                "completeness": "Completeness",
                "clarity": "Clarity",
                "feasibility": "Feasibility",
                "development_estimation": "Development Estimation",
                "recommended_frameworks": "Recommended Frameworks",
                "analysis_summary": "Analysis Summary",
                "analyzing_image_please_wait": "Analyzing image, please wait...",
                "analyzing_requirements_please_wait": "Analyzing requirements, please wait...",
                "analysis_completed_meta": "Analysis completed",
                "analysis_type_meta": "Analysis Type",
                "timestamp_meta": "Timestamp",
                "model_used_meta": "Model Used",
                "confidence_meta": "Confidence",
                "unknown": "Unknown",
                "na": "N/A",
                
                # Requirements analysis progress messages
                "analyzing_project_overview": "ðŸ” Analyzing project overview...",
                "extracting_requirements": "ðŸ“‹ Extracting and categorizing requirements...",
                "analyzing_ui_components": "ðŸŽ¨ Analyzing {count} UI components...",
                "no_ui_components_found": "âš ï¸ No UI component requirements found, skipping component analysis.",
                "analyzing_component": "Analyzing component {current}/{total}: {title}",
                "component_analysis_complete": "âœ… Component {title} analysis complete",
                "component_analysis_failed": "âš ï¸ Component {title} analysis failed",
                "starting_requirements_analysis": "Starting requirements analysis...",
                "analyzing_requirements_overview": "Analyzing requirements overview...",
                "extracting_categorizing_requirements": "Extracting and categorizing requirements...",
                "analyzing_ui_components_phase": "Analyzing UI components...",
                "analyzing_layout_interactions": "Analyzing layout and interactions...",
                "validating_requirements": "Validating requirements...",
                "requirements_analysis_completed": "Requirements analysis completed",
                
                # Gap analysis messages
                "gap_no_ui_components": "No specific UI components identified",
                "gap_no_layout": "Layout structure not defined",
                "gap_no_styling": "Visual styling requirements missing",
                "gap_no_interactions": "User interaction patterns not specified",
                "gap_missing_description": "Requirement '{title}' lacks description",
                "gap_missing_acceptance_criteria": "Acceptance criteria missing for '{title}'",
                
                # Recommendation messages
                "recommendation_address_gaps": "Address missing requirements to ensure complete specification",
                "recommendation_clarify_ambiguities": "Clarify ambiguous requirements to avoid implementation confusion",
                "recommendation_reduce_critical": "Consider reducing critical requirements - too many critical items may impact delivery",
                "recommendation_identify_critical": "Identify critical requirements to prioritize development effort",
                
                # Ambiguity messages
                "ambiguity_vague_language": "Vague language in '{title}': contains '{word}'",
                "ambiguity_contradictory": "Contradictory complexity requirements in '{title}'",
                
                # Two-phase analysis messages
                "starting_requirements_list_extraction": "Starting requirements list extraction...",
                "extracting_requirements_list": "ðŸ“‹ Extracting requirements list...",
                "requirements_list_extraction_completed": "Requirements list extraction completed",
                "starting_detailed_analysis": "Starting detailed analysis...",
                "analyzing_requirement_detail": "Analyzing requirement {current}/{total}: {title}",
                "detailed_analysis_completed": "Detailed analysis completed",
                "recommendation_proceed_detailed_analysis": "Recommend proceeding with detailed analysis for complete requirement specification",
                "analyzing_component_detail": "Analyzing component in detail: {title}",
                "analyzing_layout_detail": "Analyzing layout in detail: {title}",
                "analyzing_interaction_detail": "Analyzing interaction in detail: {title}",
                "layout_analysis_complete": "âœ… Layout {title} analysis complete",
                "layout_analysis_failed": "âš ï¸ Layout {title} analysis failed",
                "interaction_analysis_complete": "âœ… Interaction {title} analysis complete",
                "interaction_analysis_failed": "âš ï¸ Interaction {title} analysis failed",
                "extract_requirement_list": "Extract Requirement List",
                "detailed_analysis": "Detailed Analysis",
                "extract_requirement_list_first": "Please extract requirement list first",
            }
        }
        
        # Set current translations
        self.set_language(self.language)
    
    def set_language(self, language: str):
        """Set the current language"""
        self.language = language
        self.current_translations = self.translations.get(language, self.translations.get("zh_CN", {}))
    
    def tr(self, key: str, default: str = None) -> str:
        """Translate a key to the current language"""
        if default is None:
            default = key
        return self.current_translations.get(key, default)
    
    def get_languages(self) -> list:
        """Get available languages"""
        return list(self.translations.keys())

# Global localization instance
_localization = Localization()

def tr(key: str, default: str = None) -> str:
    """Global translation function"""
    return _localization.tr(key, default)

def set_language(language: str):
    """Set global language"""
    _localization.set_language(language)

def get_languages() -> list:
    """Get available languages"""
    return _localization.get_languages()